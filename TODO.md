# wxapkg æºç è¿˜åŸåŠŸèƒ½è®¡åˆ’

## ğŸ“‹ æ¦‚è¿°

å¾®ä¿¡å°ç¨‹åºåœ¨æ‰“åŒ…ä¸º `.wxapkg` åï¼Œæºç ä¼šè¢«ç¼–è¯‘/å‹ç¼©ã€‚æœ¬è®¡åˆ’ä¸“æ³¨äºå°†è¿™äº›ç¼–è¯‘äº§ç‰©è¿˜åŸä¸ºå¯è¯»çš„åŸå§‹æºç ã€‚

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### ğŸ¨ WXSS æ ·å¼è¿˜åŸ âœ…

| åŠŸèƒ½                                     | çŠ¶æ€ |
| ---------------------------------------- | ---- |
| ä» `page-frame.html` æå– `<style>` å†…å®¹ | âœ…   |
| è§£æ `setCssToHead` å‡½æ•°                 | âœ…   |
| rpx å•ä½è¿˜åŸ                             | âœ…   |
| é€‰æ‹©å™¨è¿˜åŸ                               | âœ…   |
| é¡µé¢çº§æ ·å¼åˆ†ç¦»                           | âœ…   |
| å…¨å±€æ ·å¼ `app.wxss`                      | âœ…   |

å®ç°æ–‡ä»¶: `restorer/wxss_restorer.py`

---

### ğŸ¯ WXML æ¨¡æ¿è¿˜åŸ âœ…

| åŠŸèƒ½                             | çŠ¶æ€ |
| -------------------------------- | ---- |
| è§£æ `$gwx` å‡½æ•°                 | âœ…   |
| z.push æŒ‡ä»¤åç¼–è¯‘                | âœ…   |
| æ ‡ç­¾è¿˜åŸ (`<view>`, `<text>` ç­‰) | âœ…   |
| å±æ€§è¿˜åŸ (`class`, `bindtap` ç­‰) | âœ…   |
| æ ¼å¼åŒ–è¾“å‡º                       | âœ…   |

å®ç°æ–‡ä»¶: `restorer/wxml_restorer.py`

---

### âš™ï¸ é…ç½®æ–‡ä»¶è¿˜åŸ âœ…

| åŠŸèƒ½                                  | çŠ¶æ€ |
| ------------------------------------- | ---- |
| è§£æ `app-config.json`                | âœ…   |
| è¿˜åŸ `app.json` (pages/window/tabBar) | âœ…   |
| é¡µé¢çº§ JSON é…ç½®                      | âœ…   |
| `project.config.json` ç”Ÿæˆ            | âœ…   |

å®ç°æ–‡ä»¶: `restorer/config_restorer.py`

---

## ğŸ“¦ å¾…å¼€å‘åŠŸèƒ½

### åˆ†åŒ…å¤„ç†

- [ ] ä¸»åŒ…è¯†åˆ« (`__APP__`)
- [ ] åˆ†åŒ…è¯†åˆ«ä¸åˆå¹¶
- [ ] è·¯å¾„ä¿®æ­£

### JavaScript æ¨¡å—

- [ ] ä» `app-service.js` æ‹†åˆ†é¡µé¢ JS
- [ ] require/export è¿˜åŸ
- [ ] npm æ¨¡å—è¯†åˆ«

### WXS è„šæœ¬

- [ ] WXS æ¨¡å—æå–
- [ ] å†…è”/å¤–éƒ¨ WXS è¿˜åŸ

### èµ„æºæ–‡ä»¶

- [ ] å›¾ç‰‡è·¯å¾„ä¿®æ­£
- [ ] Base64 å›¾ç‰‡è¿˜åŸ
- [ ] å­—ä½“/éŸ³è§†é¢‘æå–

---

## ğŸ”§ å½“å‰æ¶æ„

```
restorer/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ wxss_restorer.py   # âœ… WXSS è¿˜åŸ
â”œâ”€â”€ wxml_restorer.py   # âœ… WXML è¿˜åŸ
â”œâ”€â”€ config_restorer.py # âœ… é…ç½®è¿˜åŸ
â”œâ”€â”€ js_splitter.py     # å¾…å¼€å‘ - JS æ‹†åˆ†
â”œâ”€â”€ wxs_extractor.py   # å¾…å¼€å‘ - WXS æå–
â””â”€â”€ subpackage.py      # å¾…å¼€å‘ - åˆ†åŒ…å¤„ç†
```

---

## ğŸ“Š ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | åŠŸèƒ½          | çŠ¶æ€      |
| ------ | ------------- | --------- |
| P0     | WXSS æ ·å¼æå– | âœ… å®Œæˆ   |
| P0     | app.json è¿˜åŸ | âœ… å®Œæˆ   |
| P1     | WXML æ¨¡æ¿è¿˜åŸ | âœ… å®Œæˆ   |
| P1     | JS æ¨¡å—æ‹†åˆ†   | â¬œ å¾…å¼€å‘ |
| P2     | åˆ†åŒ…åˆå¹¶      | â¬œ å¾…å¼€å‘ |
| P3     | WXS æå–      | â¬œ å¾…å¼€å‘ |

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [wxappUnpacker](https://github.com/qwerty472123/wxappUnpacker) - Node.js å®ç°
- [unveilr](https://github.com/pzh2386034/unveilr) - Rust å®ç°
- [å¾®ä¿¡å°ç¨‹åºé€†å‘åˆ†æ](https://misakikata.github.io/2021/03/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A7%A3%E5%8C%85/)
